<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>الصفحة الرئيسية</title>
  <link rel="stylesheet" href="home.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.7.2/css/lightgallery-bundle.min.css">
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.2/lightgallery.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.2/plugins/thumbnail/lg-thumbnail.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.2/plugins/zoom/lg-zoom.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.2/plugins/fullscreen/lg-fullscreen.umd.js"></script>
</head>

<body>
  <header>
    <div class="header-center">
      <h1 class="app-title">الصفحة الرئيسية</h1>
    </div>
  </header>

  <main>
    <div class="search-container">
      <input type="text" id="search" placeholder="ابحث عن الصور...">
    </div>

    <div id="lightgallery" class="gallery"></div>
  </main>

  <script>
    const loadImages = async () => {
      const res = await fetch('../assets/home/images.json');
      const images = await res.json();
      const gallery = document.getElementById('lightgallery');
      gallery.innerHTML = '';

      images.forEach(img => {
        const item = document.createElement('a');
        item.href = `../assets/home/${img.file}`;
        item.dataset.subHtml = `<h4>${img.name}</h4>`;
        item.dataset.downloadUrl = `../assets/home/${img.file}`;
        item.className = 'gallery-item';
        item.innerHTML = `<img src="../assets/home/${img.file}" alt="${img.name}">`;
        gallery.appendChild(item);
      });

      initLightGallery();
    };

    const initLightGallery = () => {
      lightGallery(document.getElementById('lightgallery'), {
        plugins: [lgZoom, lgThumbnail, lgFullscreen],
        speed: 400,
        download: true,
        actualSize: false,
        selector: '.gallery-item',
        mode: 'lg-fade',
        backdropDuration: 300,
        zoomFromOrigin: false,
        mobileSettings: {
          controls: true,
          showCloseIcon: true,
          download: true,
          rotate: false,
          pinchZoom: true
        }
      });
    };

    document.getElementById('search').addEventListener('input', async (e) => {
      const query = e.target.value.trim();
      const res = await fetch('../assets/home/images.json');
      const images = await res.json();
      const filtered = images.filter(img => img.name.includes(query));
      const gallery = document.getElementById('lightgallery');

      gallery.innerHTML = '';
      filtered.forEach(img => {
        const item = document.createElement('a');
        item.href = `../assets/home/${img.file}`;
        item.dataset.subHtml = `<h4>${img.name}</h4>`;
        item.dataset.downloadUrl = `../assets/home/${img.file}`;
        item.className = 'gallery-item';
        item.innerHTML = `<img src="../assets/home/${img.file}" alt="${img.name}">`;
        gallery.appendChild(item);
      });

      initLightGallery();
    });

    loadImages();
  </script>
</body>
</html>
