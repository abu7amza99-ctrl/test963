<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>الصفحة الرئيسية</title>
  <link rel="stylesheet" href="../css/home.css">
  <link href="https://fonts.googleapis.com/css2?family=Reem+Kufi&display=swap" rel="stylesheet">

  <!-- LightGallery -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/css/lightgallery-bundle.min.css">
</head>
<body>
  <header>
    <div class="header-center">
      <div class="app-title">الصفحة الرئيسية</div>
    </div>
  </header>

  <main>
    <div class="search-container">
      <input type="text" id="search" placeholder="ابحث عن الصور...">
    </div>

    <div id="gallery" class="gallery"></div>
  </main>

  <!-- مكتبة LightGallery -->
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/lightgallery.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/plugins/zoom/lg-zoom.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.umd.js"></script>

  <script>
    async function loadImages() {
      try {
        const res = await fetch('../assets/home/images.json');
        const images = await res.json();

        const gallery = document.getElementById('gallery');
        gallery.innerHTML = '';

        images.forEach(img => {
          const item = document.createElement('a');
          item.href = `../assets/home/${img.file}`;
          item.setAttribute('data-sub-html', `<h4>${img.name}</h4>`);
          item.classList.add('gallery-item');

          const image = document.createElement('img');
          image.src = `../assets/home/${img.file}`;
          image.alt = img.name;
          item.appendChild(image);

          // زر تحميل فعلي
          const downloadBtn = document.createElement('a');
          downloadBtn.href = `../assets/home/${img.file}`;
          downloadBtn.download = img.file;
          downloadBtn.textContent = 'تحميل';
          downloadBtn.className = 'download-btn';
          item.appendChild(downloadBtn);

          gallery.appendChild(item);
        });

        // تفعيل LightGallery
        lightGallery(gallery, {
          plugins: [lgZoom, lgThumbnail],
          speed: 500,
          backdropColor: 'rgba(212, 175, 55, 0.1)'
        });

        // البحث
        const searchInput = document.getElementById('search');
        searchInput.addEventListener('input', () => {
          const query = searchInput.value.trim().toLowerCase();
          document.querySelectorAll('.gallery-item').forEach(item => {
            const name = item.querySelector('img').alt.toLowerCase();
            item.style.display = name.includes(query) ? 'block' : 'none';
          });
        });
      } catch (err) {
        console.error('خطأ بتحميل الصور:', err);
      }
    }

    loadImages();
  </script>
</body>
</html>
